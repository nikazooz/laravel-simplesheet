<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mapping data | Laravel Simplesheet</title>
    <meta name="description" content="Easy spreadsheet exports and imports in Laravel">
    <link href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,600,700" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/laravel-simplesheet/assets/css/0.styles.3edff06a.css" as="style"><link rel="preload" href="/laravel-simplesheet/assets/js/app.2f6b65ea.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/2.551ce4ff.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/17.48d593d3.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/3.bdd842d7.js" as="script"><link rel="prefetch" href="/laravel-simplesheet/assets/js/10.c3b815f0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/11.f755bf3d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/12.f81fe249.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/13.7b301b86.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/14.d160a995.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/15.c30ac0bf.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/16.24bb3db5.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/18.dd1a8114.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/19.91dfb4d2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/20.c47f6615.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/21.2a8314ab.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/22.316f26ce.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/23.91850514.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/24.c46d1939.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/25.6adfa701.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/26.5a0c4e03.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/27.8ae06553.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/28.9d1a3ff0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/29.56f77829.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/30.d0684854.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/31.7d41b98c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/32.ad4c21b8.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/33.986145c7.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/34.6d18657b.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/35.639a139e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/36.e8c60662.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/37.0f0b8516.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/38.fafb2c93.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/39.d0bbd46d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/4.f1b82287.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/40.5682347f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/41.8df75cf6.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/42.d25f2d94.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/43.06e17527.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/44.32d1ae33.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/45.28d3db5d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/46.ae21842f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/47.2a33e94f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/48.e7c516c6.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/49.551737ac.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/5.49991878.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/50.1a9d3ac9.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/51.cf21315e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/52.47e1650c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/53.0eb78260.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/54.36e9bdf4.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/55.b01fd784.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/56.e5f3f871.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/57.39c75e7a.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/58.0e33dedd.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/59.5835dafd.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/6.66f7a0b4.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/60.f1acdfe2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/61.e8d0bc00.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/62.94514efe.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/63.70fb2c02.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/64.d14f059d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/65.6f148088.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/66.98d3b9b3.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/67.e18e9e9e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/68.df5180b1.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/69.4f8b353f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/7.da4a268e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/70.ee51b03a.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/71.df7e68fd.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/72.8da1f818.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/73.5ad5bc05.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/74.860cdeab.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/75.9b37a054.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/76.6a1d1ee2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/77.c94b8435.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/78.0da030a2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/79.deafbab1.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/8.3833bcc4.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/9.709e89d6.js">
    <link rel="stylesheet" href="/laravel-simplesheet/assets/css/0.styles.3edff06a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/laravel-simplesheet/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Simplesheet</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.x/" class="nav-link router-link-active">1.x</a></li><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/2.x/" class="nav-link">2.x</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.x/" class="nav-link router-link-active">1.x</a></li><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/2.x/" class="nav-link">2.x</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Architecture Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Exports</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel-simplesheet/1.x/exports/" class="sidebar-link">🚀 5 minutes quick start</a></li><li><a href="/laravel-simplesheet/1.x/exports/collection.html" class="sidebar-link">Exporting collections</a></li><li><a href="/laravel-simplesheet/1.x/exports/store.html" class="sidebar-link">Storing exports on disk</a></li><li><a href="/laravel-simplesheet/1.x/exports/export-formats.html" class="sidebar-link">Export formats</a></li><li><a href="/laravel-simplesheet/1.x/exports/exportables.html" class="sidebar-link">Exportables</a></li><li><a href="/laravel-simplesheet/1.x/exports/from-query.html" class="sidebar-link">From Query</a></li><li><a href="/laravel-simplesheet/1.x/exports/queued.html" class="sidebar-link">Queued</a></li><li><a href="/laravel-simplesheet/1.x/exports/multiple-sheets.html" class="sidebar-link">Multiple Sheets</a></li><li><a href="/laravel-simplesheet/1.x/exports/mapping.html" class="active sidebar-link">Mapping data</a></li><li><a href="/laravel-simplesheet/1.x/exports/concerns.html" class="sidebar-link">Export concerns</a></li><li><a href="/laravel-simplesheet/1.x/exports/extending.html" class="sidebar-link">Extending</a></li><li><a href="/laravel-simplesheet/1.x/exports/testing.html" class="sidebar-link">Testing</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Imports</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="mapping-data"><a href="#mapping-data" aria-hidden="true" class="header-anchor">#</a> Mapping data</h1> <p></p><div class="table-of-contents"><ul><li><a href="#mapping-rows">Mapping rows</a></li><li><a href="#adding-a-heading-row">Adding a heading row</a></li></ul></div><p></p> <h3 id="mapping-rows"><a href="#mapping-rows" aria-hidden="true" class="header-anchor">#</a> Mapping rows</h3> <p>By adding <code>WithMapping</code> you map the data that needs to be added as row. This way you have control over the actual source for each column.
In case of using the Eloquent query builder:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>FromQuery</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMapping</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">InvoicesExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromQuery</span><span class="token punctuation">,</span> WithMapping
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * @var Invoice $invoice
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">map</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token variable">$invoice</span><span class="token operator">-&gt;</span><span class="token property">invoice_number</span><span class="token punctuation">,</span>
            <span class="token class-name static-context">Date</span><span class="token operator">::</span><span class="token function">dateTimeToExcel</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token operator">-&gt;</span><span class="token property">created_at</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="adding-a-heading-row"><a href="#adding-a-heading-row" aria-hidden="true" class="header-anchor">#</a> Adding a heading row</h3> <p>A heading row can easily be added by adding the <code>WithHeadings</code> concern. The heading row will be added
as very first row of the sheet.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>FromQuery</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithHeadings</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">InvoicesExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromQuery</span><span class="token punctuation">,</span> WithHeadings
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">headings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'#'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'Date'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>If you need to have multiple heading rows, you can return multiple rows from the <code>headings()</code> method:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>FromQuery</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithHeadings</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">InvoicesExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromQuery</span><span class="token punctuation">,</span> WithHeadings
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">headings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
           <span class="token punctuation">[</span><span class="token string single-quoted-string">'First row'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'First row'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span><span class="token string single-quoted-string">'Second row'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Second row'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/nikazooz/laravel-simplesheet-docs/edit/master/1.x/exports/mapping.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/laravel-simplesheet/1.x/exports/multiple-sheets.html" class="prev">
          Multiple Sheets
        </a></span> <span class="next"><a href="/laravel-simplesheet/1.x/exports/concerns.html">
          Export concerns
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/laravel-simplesheet/assets/js/app.2f6b65ea.js" defer></script><script src="/laravel-simplesheet/assets/js/2.551ce4ff.js" defer></script><script src="/laravel-simplesheet/assets/js/17.48d593d3.js" defer></script><script src="/laravel-simplesheet/assets/js/3.bdd842d7.js" defer></script>
  </body>
</html>
