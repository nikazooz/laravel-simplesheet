(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{310:function(t,s,e){"use strict";e.r(s);var a=e(49),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"lifecycle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lifecycle","aria-hidden":"true"}},[t._v("#")]),t._v(" Lifecycle")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#introduction"}},[t._v("Introduction")])]),e("li",[e("a",{attrs:{href:"#exports-lifecycle-overview"}},[t._v("Exports Lifecycle Overview")]),e("ul",[e("li",[e("a",{attrs:{href:"#export-object"}},[t._v("Export Object")])]),e("li",[e("a",{attrs:{href:"#passing-on-the-export-object"}},[t._v("Passing on the Export object")])]),e("li",[e("a",{attrs:{href:"#handling-the-export-object"}},[t._v("Handling the Export object")])]),e("li",[e("a",{attrs:{href:"#passing-on-to-box-spout"}},[t._v("Passing on to Box Spout")])]),e("li",[e("a",{attrs:{href:"#creating-a-response"}},[t._v("Creating a Response")])])])]),e("li",[e("a",{attrs:{href:"#imports-lifecycle-overview"}},[t._v("Imports Lifecycle Overview")]),e("ul",[e("li",[e("a",{attrs:{href:"#import-object"}},[t._v("Import Object")])]),e("li",[e("a",{attrs:{href:"#passing-on-the-import-object"}},[t._v("Passing on the Import object")])]),e("li",[e("a",{attrs:{href:"#handling-the-import-object"}},[t._v("Handling the Import object")])])])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[t._v("When using a package in your application, it's good to understand how the package functions behind the scenes.\nUnderstanding the behind-the-scenes will make you feel more comfortable and confident using the maximum potential of the tool.")]),t._v(" "),e("p",[t._v("The goal of this page is to give you a high-level overview of how Laravel Simplesheet works.")]),t._v(" "),e("h2",{attrs:{id:"exports-lifecycle-overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exports-lifecycle-overview","aria-hidden":"true"}},[t._v("#")]),t._v(" Exports Lifecycle Overview")]),t._v(" "),e("p",[t._v("This section will try to give you an overview of how the export works behind the scenes.")]),t._v(" "),e("h3",{attrs:{id:"export-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#export-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Export Object")]),t._v(" "),e("p",[t._v("Everything starts with the "),e("code",[t._v("Export")]),t._v(" object. This object "),e("strong",[t._v("encapsulates")]),t._v(" your entire export logic.\nIt both configures and handles the export logic.")]),t._v(" "),e("p",[t._v("A simple example of an export object is:")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token php language-php"}},[e("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("FromCollection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UsersExport")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FromCollection")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("collection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("User")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])]),e("p",[t._v("If you want to read more about export objects, go to the architecture page of "),e("router-link",{attrs:{to:"/1.0/architecture/objects.html"}},[t._v("export objects")]),t._v(".")],1),t._v(" "),e("h3",{attrs:{id:"passing-on-the-export-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#passing-on-the-export-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Passing on the Export object")]),t._v(" "),e("p",[t._v("Next the Export object will be passed on to the Laravel Simplesheet package. The main entry point for this is the "),e("code",[t._v("Nikazooz\\Simplesheet\\Simplesheet")]),t._v(" class. This class can be called in multiple ways.")]),t._v(" "),e("h4",{attrs:{id:"facade"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#facade","aria-hidden":"true"}},[t._v("#")]),t._v(" Facade")]),t._v(" "),e("p",[t._v("The easiest way to work with the "),e("code",[t._v("Simplesheet")]),t._v(" class is to use the "),e("code",[t._v("Nikazooz\\Simplesheet\\Facades\\Simplesheet")]),t._v(" facade.\nIf you use "),e("a",{attrs:{href:"https://laravel.com/docs/packages#package-discovery",target:"_blank",rel:"noopener noreferrer"}},[t._v("auto-discovery"),e("OutboundLink")],1),t._v(", you can use the alias "),e("code",[t._v("\\Simplesheet")]),t._v(" directly instead of using the fully qualified namespace.")]),t._v(" "),e("h4",{attrs:{id:"dependency-injection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dependency-injection","aria-hidden":"true"}},[t._v("#")]),t._v(" Dependency injection")]),t._v(" "),e("p",[t._v("You can inject the "),e("code",[t._v("Nikazooz\\Simplesheet\\Simplesheet")]),t._v(" manager class into your class, either via constructor injection\nor method injection in case of a controller.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token php language-php"}},[e("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("ExportController")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$simplesheet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__construct")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("Simplesheet")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$simplesheet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("simplesheet")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$simplesheet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("exportViaConstructorInjection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("simplesheet")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("exportViaMethodInjection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("Simplesheet")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$simplesheet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$simplesheet")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br")])]),e("h4",{attrs:{id:"contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#contract","aria-hidden":"true"}},[t._v("#")]),t._v(" Contract")]),t._v(" "),e("p",[t._v("You can also use the "),e("code",[t._v("Nikazooz\\Simplesheet\\Exporter")]),t._v(" interface to decouple more from the concrete Simplesheet manager implementation. The contract offers the same methods as the "),e("code",[t._v("Simplesheet")]),t._v(" class.\nIt will make it easier to e.g. stub out the Exporter in your unit tests. The "),e("code",[t._v("Exporter")]),t._v(" contract can be either injected via the constructor or a method in a controller.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exporter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("ExportsController")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$exporter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__construct")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("Exporter")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$exporter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("exporter")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$exporter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("export")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("exporter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br")])]),e("h4",{attrs:{id:"container-binding"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#container-binding","aria-hidden":"true"}},[t._v("#")]),t._v(" Container binding")]),t._v(" "),e("p",[t._v("If you want to bind the "),e("code",[t._v("Nikazooz\\Simplesheet\\Simplesheet")]),t._v(" manager to your own class via a container binding, you can use the "),e("code",[t._v("simplesheet")]),t._v(" container binding.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("YourCustomExporter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("YourCustomExporter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'simplesheet'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h4",{attrs:{id:"exportable-trait"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exportable-trait","aria-hidden":"true"}},[t._v("#")]),t._v(" Exportable trait")]),t._v(" "),e("p",[t._v("If you prefer a sprinkle of magic, you can use the "),e("code",[t._v("Nikazooz\\Simplesheet\\Concerns\\Exportable")]),t._v(" trait in your "),e("code",[t._v("Export")]),t._v(" object. This trait will expose a couple of methods that will make it possible to directly export an "),e("code",[t._v("Export")]),t._v(" object.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("FromCollection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Exportable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UsersExport")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FromCollection")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Exportable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("collection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("User")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br")])]),e("p",[t._v("You can now download the export without the need for the "),e("code",[t._v("facade")]),t._v(" or "),e("code",[t._v("Simplesheet")]),t._v(" manager.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersExport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("Read more about the exportable trait in the "),e("router-link",{attrs:{to:"/1.0/exports/exportables.html"}},[t._v("exportables")]),t._v(" docs.")],1),t._v(" "),e("h3",{attrs:{id:"handling-the-export-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#handling-the-export-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Handling the Export object")]),t._v(" "),e("h4",{attrs:{id:"writer-type-detection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#writer-type-detection","aria-hidden":"true"}},[t._v("#")]),t._v(" Writer type detection")]),t._v(" "),e("p",[t._v("After using one of the above methods to pass on the "),e("code",[t._v("Export")]),t._v(" object to the "),e("code",[t._v("Simplesheet")]),t._v(" manager, it will try to figure out what export it needs to be generated to.\nThis will be either based on the extension of the file, the explicitly passed writer type. You can find the extension to writer type mapping in the "),e("code",[t._v("simplesheet.php")]),t._v(" config, in the "),e("code",[t._v("extension_detector")]),t._v(" section.\nIn case no writer type can be detected, a "),e("code",[t._v("Nikazooz\\Simplesheet\\Exceptions\\NoTypeDetectedException")]),t._v(" exception is thrown and the export process will be stopped.")]),t._v(" "),e("h4",{attrs:{id:"starting-the-writing-process"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#starting-the-writing-process","aria-hidden":"true"}},[t._v("#")]),t._v(" Starting the Writing process")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("Simplesheet")]),t._v(" manager will then delegate the handling to the "),e("code",[t._v("Nikazooz\\Simplesheet\\Writer")]),t._v(". The first action of the "),e("code",[t._v("Writer")]),t._v(" is to register the event listeners that are registered.")]),t._v(" "),e("p",[t._v("The first event that is raised, is the "),e("code",[t._v("BeforeExport")]),t._v(" event. This is raised just after the "),e("code",[t._v("Box\\Spout\\Writer\\WriterInterface")]),t._v(" instance is created and allows early access to it.")]),t._v(" "),e("h4",{attrs:{id:"multiple-sheets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#multiple-sheets","aria-hidden":"true"}},[t._v("#")]),t._v(" Multiple sheets")]),t._v(" "),e("p",[t._v("Next the "),e("code",[t._v("Writer")]),t._v(" will determine if multiple sheets are configured, by checking for the "),e("code",[t._v("Nikazooz\\Simplesheet\\Concerns\\WithMultipleSheets")]),t._v(" concern.")]),t._v(" "),e("p",[t._v("Then it will delegate the further handling of each sheet to the "),e("code",[t._v("Nikazooz\\Simplesheet\\Sheet")]),t._v(" class.")]),t._v(" "),e("h4",{attrs:{id:"processing-the-sheets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#processing-the-sheets","aria-hidden":"true"}},[t._v("#")]),t._v(" Processing the sheets")]),t._v(" "),e("p",[t._v("In the "),e("code",[t._v("Sheet")]),t._v(" class, the most heavy lifting happens. It first will create a "),e("code",[t._v("Box\\Spout\\Writer\\Common\\Sheet")]),t._v(" instance. Then it will raise the "),e("code",[t._v("BeforeSheet")]),t._v(" event which allows you to hook into the moment just before the sheet handling starts.")]),t._v(" "),e("p",[t._v("Then it will determine what kind of export we are dealing with: "),e("code",[t._v("FromQuery")]),t._v(", "),e("code",[t._v("FromArray")]),t._v(", "),e("code",[t._v("FromCollection")]),t._v(" or "),e("code",[t._v("FromView")]),t._v(". Based on that it will start the connected export process.")]),t._v(" "),e("ul",[e("li",[t._v("The "),e("strong",[t._v("Query")]),t._v(" passed with the "),e("code",[t._v("FromQuery")]),t._v(" will automatically be chunked and each chunk will be appended to the Sheet. The chunking is done to limit the amount of Eloquent object it needs to keep in memory. It greatly reduces memory usage.")]),t._v(" "),e("li",[t._v("The entire array of Collection will directly be appended to the Sheet.")])]),t._v(" "),e("p",[t._v("When the "),e("code",[t._v("Sheet")]),t._v(" starts appending records, it will first call the "),e("code",[t._v("map()")]),t._v(" method if the "),e("code",[t._v("WithMapping")]),t._v(" concern is used. This allows the "),e("code",[t._v("Export")]),t._v(" object to format the data before it is inserted.")]),t._v(" "),e("p",[t._v("Then it will handling column formatting ("),e("code",[t._v("WithColumnFormatting")]),t._v(" concern) and cell autosizing ("),e("code",[t._v("ShouldAutoSize")]),t._v(").")]),t._v(" "),e("p",[t._v("To close off the Sheet processing, it will raise a "),e("code",[t._v("AfterSheet")]),t._v(" event.")]),t._v(" "),e("h3",{attrs:{id:"passing-on-to-box-spout"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#passing-on-to-box-spout","aria-hidden":"true"}},[t._v("#")]),t._v(" Passing on to Box Spout")]),t._v(" "),e("p",[t._v("After the sheets are processed, the writing process will start. The writing process is started by raising the "),e("code",[t._v("BeforeWriting")]),t._v(" event; this allow you to hook into the process of writing.\nNext we will create a new "),e("code",[t._v("Box Spout Writer")]),t._v(" based on the writer type that was determined. Then it will save it to a temporary file and return that filepath to the "),e("code",[t._v("Simplesheet")]),t._v(" manager.")]),t._v(" "),e("h3",{attrs:{id:"creating-a-response"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-response","aria-hidden":"true"}},[t._v("#")]),t._v(" Creating a Response")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("Simplesheet")]),t._v(" manager basically has 2 types of responses, it either starts the "),e("strong",[t._v("download")]),t._v(" process or it will "),e("strong",[t._v("store")]),t._v(" the file to disk.")]),t._v(" "),e("h4",{attrs:{id:"download-the-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#download-the-file","aria-hidden":"true"}},[t._v("#")]),t._v(" Download the file")]),t._v(" "),e("p",[t._v("We will take the temporary file that was returned by the "),e("code",[t._v("Writer")]),t._v(" and use Laravel's "),e("code",[t._v("ResponseFactory")]),t._v(" to create a "),e("code",[t._v("Symfony\\Component\\HttpFoundation\\BinaryFileResponse")]),t._v(". When returning this response in your controller, it will start a download.")]),t._v(" "),e("h4",{attrs:{id:"storing-the-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#storing-the-file","aria-hidden":"true"}},[t._v("#")]),t._v(" Storing the file")]),t._v(" "),e("p",[t._v("The storing of the file will be handled by Laravel's "),e("code",[t._v("Filesystem")]),t._v(". By default the file will be stored on your "),e("code",[t._v("default")]),t._v(" disk, but you can also pass a custom disk via the "),e("code",[t._v("Simplesheet::store()")]),t._v(" method.")]),t._v(" "),e("h2",{attrs:{id:"imports-lifecycle-overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#imports-lifecycle-overview","aria-hidden":"true"}},[t._v("#")]),t._v(" Imports Lifecycle Overview")]),t._v(" "),e("p",[t._v("This section will try to give you an overview of how the import works behind the scenes.")]),t._v(" "),e("h3",{attrs:{id:"import-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#import-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Import Object")]),t._v(" "),e("p",[t._v("Everything starts with the "),e("code",[t._v("Import")]),t._v(" object. This object "),e("strong",[t._v("encapsulates")]),t._v(" your entire import logic.\nIt both configures and handles the import logic.")]),t._v(" "),e("p",[t._v("A simple example of an import object is:")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Imports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Support"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Collection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ToCollection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UsersImport")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ToCollection")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("collection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("Collection")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rows")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rows")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$row")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("User")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'name'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$row")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br")])]),e("p",[t._v("If you want to read more about imports objects, go to the architecture page of "),e("router-link",{attrs:{to:"/1.0/architecture/objects.html"}},[t._v("imports objects")]),t._v(".")],1),t._v(" "),e("h3",{attrs:{id:"passing-on-the-import-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#passing-on-the-import-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Passing on the Import object")]),t._v(" "),e("p",[t._v("Next the Import object will be passed on to the Laravel Simplesheet package. The main entry point for this is the "),e("code",[t._v("Nikazooz\\Simplesheet\\Simplesheet")]),t._v(" class. This class can be called in the same way as outlined in the Export lifecycle.")]),t._v(" "),e("h4",{attrs:{id:"contract-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#contract-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Contract")]),t._v(" "),e("p",[t._v("You can also use the "),e("code",[t._v("Nikazooz\\Simplesheet\\Importer")]),t._v(" interface to decouple more from the concrete Simplesheet manager implementation. The contract offers the same methods as the "),e("code",[t._v("Simplesheet")]),t._v(" class.\nIt will make it easier to e.g. stub out the Importer in your unit tests. The "),e("code",[t._v("Importer")]),t._v(" contract can be either injected via the constructor or the method of a controller.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Imports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("UsersImport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Importer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("ImportsController")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$importer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__construct")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("Importer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$importer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("importer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$importer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("export")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("importer")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersImport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br")])]),e("h4",{attrs:{id:"importable-trait"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#importable-trait","aria-hidden":"true"}},[t._v("#")]),t._v(" Importable trait")]),t._v(" "),e("p",[t._v("If you prefer a sprinkle of magic, you can use the "),e("code",[t._v("Nikazooz\\Simplesheet\\Concerns\\Importable")]),t._v(" trait in your "),e("code",[t._v("Import")]),t._v(" object. This trait will expose a couple of methods that will make it possible to directly import an "),e("code",[t._v("Import")]),t._v(" object.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Imports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ToCollection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Nikazooz"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Simplesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Importable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UsersImport")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ToCollection")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Importable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br")])]),e("p",[t._v("You can now import without the need for the "),e("code",[t._v("facade")]),t._v(" or "),e("code",[t._v("Simplesheet")]),t._v(" manager.")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsersImport")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'users.xlsx'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("Read more about the importable trait in the "),e("router-link",{attrs:{to:"/1.0/imports/importables.html"}},[t._v("importables")]),t._v(" docs.")],1),t._v(" "),e("h3",{attrs:{id:"handling-the-import-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#handling-the-import-object","aria-hidden":"true"}},[t._v("#")]),t._v(" Handling the Import object")]),t._v(" "),e("h4",{attrs:{id:"reader-type-detection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#reader-type-detection","aria-hidden":"true"}},[t._v("#")]),t._v(" Reader type detection")]),t._v(" "),e("p",[t._v("After using one of the above methods to pass on the "),e("code",[t._v("Import")]),t._v(" object to the "),e("code",[t._v("Simplesheet")]),t._v(" manager, it will try to figure out what reader type it is .\nThis will be either based on the extension of the file or the explicitly passed reader type. You can find the extension to reader type mapping in the "),e("code",[t._v("simplesheet.php")]),t._v(" config, in the "),e("code",[t._v("extension_detector")]),t._v(" section.\nIn case no reader type can be detected, a "),e("code",[t._v("Nikazooz\\Simplesheet\\Exceptions\\NoTypeDetectedException")]),t._v(" exception is thrown and the import process will be stopped.")]),t._v(" "),e("h4",{attrs:{id:"starting-the-reading-process"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#starting-the-reading-process","aria-hidden":"true"}},[t._v("#")]),t._v(" Starting the Reading process")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("Simplesheet")]),t._v(" manager will then delegate the handling to the "),e("code",[t._v("Nikazooz\\Simplesheet\\Reader")]),t._v(". The first action of the "),e("code",[t._v("Reader")]),t._v(" is to register the event listeners that are registered.\nIt will copy the file from Laravel's "),e("code",[t._v("Filesystem")]),t._v(" to the local filesystem, so Box Spout can read it.\nNext it will create a Box Spout "),e("code",[t._v("Reader")]),t._v(" based on the reader type that was given and load the file into a "),e("code",[t._v("Box\\Spout\\Reader\\ReaderInterface")]),t._v(" instance.")]),t._v(" "),e("p",[t._v("The first event that is raised, is the "),e("code",[t._v("BeforeImport")]),t._v(" event. This is raised just after the "),e("code",[t._v("Box\\Spout\\Reader\\ReaderInterface")]),t._v(" instance is loaded and allows early access to it.")]),t._v(" "),e("h4",{attrs:{id:"multiple-sheets-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#multiple-sheets-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Multiple sheets")]),t._v(" "),e("p",[t._v("Next we will determine if we are dealing with multiple sheets. This is done based on the "),e("code",[t._v("WithMultipleSheets")]),t._v(" concern.")]),t._v(" "),e("h4",{attrs:{id:"processing-the-sheets-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#processing-the-sheets-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Processing the sheets")]),t._v(" "),e("p",[t._v("Then each Sheet gets processed. This process gets started off by raising the "),e("code",[t._v("BeforeSheet")]),t._v(" event.\nThen it will either import it to a Collection, an array or handle each row as an Eloquent model.")]),t._v(" "),e("ul",[e("li",[t._v("When using "),e("code",[t._v("ToModel")]),t._v(", each returned model will be persisted via Eloquent. When using this in combination with "),e("code",[t._v("WithBatchInserts")]),t._v(", it will defer the persistence till the batch is complete and then insert them as one batch in the database.")]),t._v(" "),e("li",[t._v("When using "),e("code",[t._v("ToCollection")]),t._v(" or "),e("code",[t._v("ToArray")]),t._v(", the entire dataset will be passed to the Import method and the user can determine itself how to use it.")])]),t._v(" "),e("p",[t._v("The sheet handling is ended by raising the "),e("code",[t._v("AfterSheet")]),t._v(" event.")])])},[],!1,null,null,null);s.default=n.exports}}]);